(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.GamepadMicro = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var GamepadMicro;!function(){var t,e,i,a,n,d,s,m,o,p,r,c,h,g,u,f,l,b,_="gamepadconnected",w="gamepaddisconnected",G="standard",v=navigator;GamepadMicro=function(){this._buttonNames=["actionSouth","actionEast","actionWest","actionNorth","leftBumper","rightBumper","leftTrigger","rightTrigger","select","start","leftStick","rightStick","dPadUp","dPadDown","dPadLeft","dPadRight","extra"],this._ticking=!1,this._prevTimestamps=[],this._connectionListening=!1,this._updateCallback=function(){},this._prevRawGamepadTypes=[],this.gamepadConnected=e.length>0,this.gamepadSupported=!!a(),this.gamepads=[],this._heldButtonDelay=200,this._heldTimestampByGamepad={}},t=function(){return{leftStick:{x:0,y:0},rightStick:{x:0,y:0},dPad:{x:0,y:0},buttons:{},_pressed:{},timestamp:0}},a=function(){return v.getGamepads||!!v.webkitGetGamepads||!!v.webkitGamepads},e=function(){var t=v.getGamepads&&v.getGamepads()||v.webkitGetGamepads&&v.webkitGetGamepads(),e=[];if(t)for(var i=0,a=t.length;i<a;i++){var n=t[i];n&&n.mapping===G&&e.push(n)}return e},i=function(t,e){if(!t||!t.buttons||e>=t.buttons.length)return!1;var i,a=t.buttons[e];return!!a&&(i=a,"object"==typeof a&&(i=a.value),1===i)},n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,d=function(){this._updateCallback(this.gamepads)}.bind(GamepadMicro),s=function(){this._connectionListening||(window.addEventListener(_,o,!1),window.addEventListener(w,p,!1),this._connectionListening=!0)}.bind(GamepadMicro),m=function(){this._connectionListening&&(window.removeEventListener(_,o),window.removeEventListener(w,p),this._connectionListening=!1)}.bind(GamepadMicro),o=function(e){var i=e.gamepad;i.mapping===G&&(this.gamepads[i.index]=t(),this.gamepadConnected=!0,d())}.bind(GamepadMicro),p=function(t){var e=t.gamepad,i=this.gamepads;i.forEach(function(t,a){a===e.index&&i.splice(a,1)}),i.length||(this.gamepadConnected=!1),d()}.bind(GamepadMicro),r=function(){for(var t=e(),i=!1,a={},n=0,d=0;d<t.length;d++){var s,m,o=t[d];o.timestamp&&(n=o.index,s=this._heldTimestampByGamepad[n]||{},m=0===Object.keys(s).length,o.timestamp===this._prevTimestamps[n]&&m||(this._prevTimestamps[n]=o.timestamp,a[n]=o,i=!0))}return!!i&&a}.bind(GamepadMicro),c=function(){var e=r();if(e){this.gamepadConnected=!0,this.gamepadSupported=!0;var a=this.gamepads,n=this._buttonNames;Object.keys(e).map(function(d){var s=e[d];if(s){typeof s!=this._prevRawGamepadTypes[d]&&(this._prevRawGamepadTypes[d]=typeof p);for(var m,o={},p=a[d]||t(),r=this._heldTimestampByGamepad[d]||{},c=0,h=n.length;c<h;c++){var g,u=n[c],f=r[u],l=!!p._pressed[u],b=p._pressed[u]=i(s,c),_=Date.now();l&&!b?(o[u]={released:!0,held:!1},r&&delete r[u]):b&&(f?(g=f.gamepadTimestamp===s.timestamp,(g&&_>f.browserTimestamp+this._heldButtonDelay||s.timestamp>f.gamepadTimestamp+this._heldButtonDelay)&&(o[u]={held:!0})):r[u]={gamepadTimestamp:s.timestamp,browserTimestamp:_})}this._heldTimestampByGamepad[d]=r,p.timestamp=s.timestamp,p.buttons=o,m=s.axes,p.leftStick.x=m[0],p.leftStick.y=m[1],p.rightStick.x=m[2],p.rightStick.y=m[3],p.dPad.x=(o.dPadLeft?-1:0)+(o.dPadRight?1:0),p.dPad.y=(o.dPadUp?-1:0)+(o.dPadDown?1:0),this.gamepads[d]=p}}.bind(this)),d()}}.bind(GamepadMicro),h=function(){this._ticking||(this._ticking=!0,u())}.bind(GamepadMicro),g=function(){this._ticking=!1}.bind(GamepadMicro),u=function(){c(),this._ticking&&n&&n(u)}.bind(GamepadMicro),f=function(t){this._updateCallback=t,s(),h()},l=function(){this._updateCallback=!1,m(),g()},b=GamepadMicro.prototype,b.onUpdate=f,b.offUpdate=l}(),module.exports=GamepadMicro;
},{}]},{},[1])(1)
});